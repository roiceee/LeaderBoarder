generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id          Int           @id @default(autoincrement()) @map("id")
    sub         String        @unique @map("sub")
    leaderboard Leaderboard[]

    @@map("users")
}

enum SourceType {
    GOOGLE_SHEET
    DIRECT_INPUT
}

model Leaderboard {
    id                  Int                @id @default(autoincrement()) @map("id")
    user                User               @relation(fields: [userId], references: [id])
    leaderboardEntries  LeaderboardEntry[]
    userId              Int                @unique @map("user_id")
    name                String             @map("name")
    sourceType          SourceType         @map("source_type")
    googleSheetId       String?            @map("google_sheet_id")
    publicSlug          String             @map("public_slug")
    slug                String             @map("slug")
    backgroundImageUrl  String?            @map("background_image_url")
    backgroundImageName String?            @map("background_image_name")

    @@map("leaderboards") 
}

model LeaderboardEntry {
    id            Int         @id @default(autoincrement()) @map("id")
    leaderboard   Leaderboard @relation(fields: [leaderboardId], references: [id])
    leaderboardId Int         @map("leaderboard_id")
    name          String      @map("name")
    score         Float       @map("score")
    imageUrl      String?     @map("image_url")
    imageName     String?     @map("image_name")

    @@map("leaderboard_entries") 
}
